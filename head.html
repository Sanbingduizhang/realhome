<div class='header'>
    <div class='header-left'>
        <ul class="header-left-li">
            <!-- <li><a href="javascript:void(0);">古道人家</a></li>
            <li><a href="javascript:void(0);">古道人家</a></li>
            <li><a href="javascript:void(0);">古道人家</a></li>
            <li><a href="javascript:void(0);">古道人家</a></li>
            <li><a href="javascript:void(0);">古道人家</a></li>
            <li><a href="javascript:void(0);">人家</a></li> -->
        </ul>
    </div>
    <div class='header-right'>
        <div class="imghead" isClick="false">
            <img src="/static/common/img/userhead.jpg" class="headimg">
        </div>
        <div class='head-img' title='头像名称'>
            <div class="head-mess head-mess-some">
                <ul>
                    <li><a href="javascript:void(0);" class="selfcenter">个人中心</a></li>
                    <!-- <li><a href="javascript:void(0);" class="articlemess">文章信息</a></li>
                    <li><a href="javascript:void(0);" class="photosmess">相册信息</a></li> -->
                    <li><a href="javascript:void(0);" class="loginOut">退出</a></li>
                </ul>
            </div>
            <div class="head-mess head-mess-sub">
                <ul>
                    <li><a href="javascript:void(0);" class="submit">登录</a></li>
                    <li><a href="javascript:void(0);" class="register">注册</a></li>
                </ul>
            </div>
        </div>

    </div>
</div>
<script>
    //头像下方显示内容的转换
    var realToken = getRealToken();
    if (realToken == undefined || realToken == '' || realToken == 'null') {
        $(".imghead").attr("isClick", "false");
    } else {
        $(".imghead").attr("isClick", "true");
    }
    //头像下方显示内容和隐藏
    $(".imghead").mouseenter(function () {
        var isclick = $(".imghead").attr("isClick");
        if (isclick == 'false') {
            $(".head-mess-sub").show();
        } else {
            $(".head-mess-some").show();
        }
    });
    $(".header-right").mouseleave(function () {
        $(".head-mess").hide();
    });
    //注册和登录相关的事件以及跳转
    //注册
    $(".register").click(function () {
        $("#bgsub").html('<div class="sub-index sub-index-zc"><div class="button-close">关闭</div>' +
            '<div class="sub-head">遇 见 过 往</div>' +
            '<div class="sub-mid">' +
            '<p>' +
            '<span>账号</span>' +
            '<span style="margin-left:5px;">' +
            '<input type="text" name="" id="zcusername" class="inputsub">' +
            '</span>' +
            '</p>' +
            '<p>' +
            '<span>密码</span>' +
            '<span style="margin-left:5px;">' +
            '<input type="password" name="" id="zcpassword" class="inputsub">' +
            '</span>' +
            '</p>' +
            '<p>' +
            '<span>昵称</span>' +
            '<span style="margin-left:5px;">' +
            '<input type="text" name="" id="zcmc" class="inputsub">' +
            '</span>' +
            '</p>' +
            '<p>' +
            '<span>邮箱</span>' +
            '<span style="margin-left:5px;">' +
            '<input type="email" name="email" id="zcemail" multiple class="inputsub">' +
            '</span>' +
            '</p>' +
            '</div>' +
            '<div class="sub-bottom">' +
            '<p class="zhucego">立即注册</p>' +
            '</div></div>');
        $("#bgsub").show();
    });

    //鼠标离开就验证
    //验证账号
    // $('#bgsub').on('blur','#zcusername',function () {
    //     var user = $("#zcusername").val();
    //     // 账号的正则验证
    //     var reguser = "^[a-zA-Z]{5,16}$";
    //     var reuser = new RegExp(reguser);
    //     if (!reuser.test(user)) {
    //         alert('账号由5-16位字母组成');
    //         return false;
    //     }
    // });
    //验证密码
    // $('#bgsub').on('blur','#zcpassword',function () {
    //     var pwd = $("#zcpassword").val();
    //     // 账号的正则验证
    //     var regepwd = "^(?![0-9]+$)(?![a-z]+$)(?![A-Z]+$)(?![,\.#%'\+\*\-:;^_`]+$)[,\.#%'\+\*\-:;^_`0-9A-Za-z]{5,16}$";
    //     var repwd = new RegExp(regepwd);
    //     if (!repwd.test(pwd)) {
    //         alert("密码由5-16位字母、数字、符号组成");
    //         return false;
    //     }
    // });
    //验证昵称
    // $('#bgsub').on('blur','#zcmc',function () {
    //     var mc = $("#zcmc").val();
    //     // 账号的正则验证
    //     var regemc = "^[\u4E00-\u9FA5\uF900-\uFA2D]{2,12}$";
    //     var repmc = new RegExp(regemc);
    //     if (!repmc.test(mc)) {
    //         alert("昵称由2-12位中文组成");
    //         return false;
    //     }
    // });
    //验证邮箱
    // $('#bgsub').on('blur','#zcemail',function () {
    //     var user = $("#zcemail").val();
    //     // 账号的正则验证
    //     var reguser = "^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$";
    //     var reuser = new RegExp(reguser);
    //     if (!reuser.test(user)) {
    //         alert('请输入正确的邮箱');
    //         return false;
    //     }
    // });


    //登录页面展示
    $(".submit").click(function () {
        $("#bgsub").html('<div class="sub-index sub-index-sub"><div class="button-close">关闭</div>' +
            '<div class="sub-head">遇 见 过 往</div>' +
            '<div class="sub-mid">' +
            '<p>' +
            '<span>账号</span>' +
            '<span>' +
            '<input type="text" name="" id="username" class="inputsub">' +
            '</span>' +
            '</p>' +
            '<p>' +
            '<span>密码</span>' +
            '<span>' +
            '<input type="password" name="" id="password" class="inputsub">' +
            '</span>' +
            '</p>' +
            '</div>' +
            '<div class="sub-bottom">' +
            '<p class="submitgo">立即登录</p>' +
            '<p class="submitfog">忘记密码</p>' +
            '</div></div>');
        $("#bgsub").show();
    });
    //登录事件
    $("#bgsub").on('click', '.submitgo', function () {
        var user = $("#username").val();
        var pwd = $("#password").val();
        // 账号的正则验证
        var reguser = "^[a-zA-Z]{5,16}$";
        var reuser = new RegExp(reguser);
        if (!reuser.test(user)) {
            alert('账号由5-16位字母组成');
            return false;
        }
        //密码的正则验证
        // var regepwd =
        //     "^(?![0-9]+$)(?![a-z]+$)(?![A-Z]+$)(?![,\.#%'\+\*\-:;^_`]+$)[,\.#%'\+\*\-:;^_`0-9A-Za-z]{5,16}$";
        // var repwd = new RegExp(regepwd);
        // if (!repwd.test(pwd)) {
        //     alert("密码由5-16位字母、数字、符号组成");
        // }
        //发送登录请求
        $.ajax({
            type: "POST",
            url: getBaseUri() + "base/login",
            dataType: "json",
            data: {
                usercode: user,
                password: pwd,
            },
            success: function (data) {
                if (data.code == 1) {
                    $.cookie('real-home-token', data.data.token, {
                        path: '/'
                    });
                    $(".imghead").attr("isClick", 'true');
                    $("#bgsub").hide();
                    myContent();
                } else {
                    alert(data.message);
                }
            },
            error: function (data) {
                console.log(data);
            }
        });
    });
    //注册事件.sub-index
    $("#bgsub").on('click', '.zhucego', function () {
        var user = $("#zcusername").val();
        var pwd = $("#zcpassword").val();
        var mc = $("#zcmc").val();
        var email = $("#zcemail").val();
        
        //验证不通过,直接退出
        var returnRes = zcyz(user,pwd,mc,email);
        if (returnRes == false) {
            return false;
        }
        // return false;
        //发送登录请求
        $.ajax({
            type: "POST",
            url: getBaseUri() + "base/register",
            dataType: "json",
            data: {
                usercode: user,
                password: pwd,
                name: mc,
                email: email,
            },
            success: function (data) {
                if (data.code == 1) {
                    alert('注册成功，请返回登录');
                    window.location.reload();
                } else {
                    alert(data.message);
                }
            },
            error: function (data) {
                alert(data.message);
                console.log(data);
            }
        });
    });


    //注册验证记录
    function zcyz(user,pwd,mc,email) {
        // 账号的正则验证
        var reguser = "^[a-zA-Z]{4,16}$";
        var reuser = new RegExp(reguser);
        if (!reuser.test(user)) {
            alert('账号由4-16位字母组成');
            return false;
        }
        //密码的正则验证
        var regepwd = "^(?![0-9]+$)(?![a-z]+$)(?![A-Z]+$)(?![,\.#%'\+\*\-:;^_`]+$)[,\.#%'\+\*\-:;^_`0-9A-Za-z]{5,16}$";
        var repwd = new RegExp(regepwd);
        if (!repwd.test(pwd)) {
            alert("密码由5-16位字母、数字、符号组成");
            return false;
        }
        //昵称验证
        var regemc = "^[\u4E00-\u9FA5\uF900-\uFA2D]{2,12}$";
        var repmc = new RegExp(regemc);
        if (!repmc.test(mc)) {
            alert("昵称由2-12位中文组成");
            return false;
        }
        //邮箱验证
        var regemail= /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;
        var reemail = new RegExp(regemail);
        if (!reemail.test(email)) {
            alert('请输入正确的邮箱');
            return false;
        }
        //验证成功返回true
        return true;
    }



    //退出事件
    $(".loginOut").click(function () {
        $.cookie('real-home-token', '', {
            path: '/'
        });
        $(".imghead").attr("isClick", 'false');
        $(".con-right-my").html(
            '<div class="con-right-all"><div class="my-some-title">我的作品>>></div><div class="con-right-nr con-right-myself"><img src="/static/common/img/timg.gif" alt="" style="width:200px; height:200px;"><p class="submit"><span>请登录。。。</span></p></div><div class="M-box1 m-style m-style-right my-box"></div></div>'
        );
        alert('退出成功');
    });
    //个人中心相关的参数调用
    $(".selfcenter").click(function () {
        window.open("/home/all.html");
    });
</script>